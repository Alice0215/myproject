webpackJsonp([22],{HxWs:function(e,n,t){e.exports={default:t("Q17y"),__esModule:!0}},Q17y:function(e,n,t){var o=t("zKeE"),a=o.JSON||(o.JSON={stringify:JSON.stringify});e.exports=function(e){return a.stringify.apply(a,arguments)}},t1lf:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=t("aIIw"),a=t.n(o),c=t("HxWs"),i=t.n(c),r=t("kcQR"),s=t.n(r),l=t("gYMV"),u=t("0WlK"),d=t("B1iE"),h=t.n(d),f={data:function(){return{borderShow:!0}},methods:{back:function(){window.QRScanner&&(window.QRScanner.cancelScan(function(e){console.log(e)}),window.QRScanner.hide()),this.$router.goBack()},handleScanResult:function(e){var n=this;return s()(a.a.mark(function t(){var o,c,r,s,d;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.borderShow=!1,n.$q.loading.show(),t.next=4,Object(l.c)(e,"get","","json",!1,!0);case 4:o=t.sent,n.$q.loading.hide(),c=o.data.resultMsg,r=c.id,s=null,c.type&&(s=c.type.key),console.log(s),d=[],c.pictures&&(h.a.forEach(c.pictures,function(e){var n=u.b.THUMBNAIL_API+e.filePath;d.push({previewUrl:n,contentUrl:e.filePath})}),localStorage.setItem("qrcode-image",i()(d))),h.a.isNull(c.location)&&localStorage.setItem("user_location",c.location),s===u.a.SINGLE||s===u.a.AREA?n.$router.push("/project/maintenance?codeId="+r):n.$router.push("/qcode/edit?id="+r+"&typeKey="+s);case 15:case"end":return t.stop()}},t,n)}))()},cancelScan:function(){window.QRScanner&&(window.QRScanner.cancelScan(function(e){console.log(e)}),window.QRScanner.hide())},openScan:function(){var e=this;window.QRScanner&&window.QRScanner.prepare(function(n,t){n&&console.error(n),t.authorized?(console.log("authorized"),window.QRScanner.scan(function(n,t){n?console.log(n):(console.log(t),e.handleScanResult(t),e.cancelScan())}),window.QRScanner.show(function(e){console.log(e)})):t.denied?(console.log(t),window.QRScanner.openSettings()):console.log(t)})}},mounted:function(){this.openScan()},beforeDestroy:function(){this.cancelScan()}},w=function(){var e=this.$createElement,n=this._self._c||e;return n("q-layout",{attrs:{id:"scan-page"}},[n("q-toolbar",{staticClass:"header"},[n("q-toolbar",{staticClass:"fix"},[n("a",{on:{click:this.back}},[n("q-item-side",{staticClass:"reback",attrs:{left:"",icon:"keyboard arrow left"}}),this._v("\n        返回")],1),this._v(" "),n("q-toolbar-title",{staticClass:"header-title"},[this._v("\n        扫描二维码\n      ")]),this._v(" "),n("q-item-side",{attrs:{right:""}})],1)],1),this._v(" "),n("q-icon",{directives:[{name:"show",rawName:"v-show",value:this.borderShow,expression:"borderShow"}],staticClass:"fixed-center",staticStyle:{"font-size":"360px",color:"lightskyblue"},attrs:{name:"ion-qr-scanner"}})],1)},p=[];w._withStripped=!0;var S=t("xRi5"),g=Object(S.a)(f,w,p,!1,null,null,null);g.options.__file="src/pages/qcode/scan.vue";n.default=g.exports}});