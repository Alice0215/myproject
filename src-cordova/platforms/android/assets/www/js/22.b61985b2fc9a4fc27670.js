webpackJsonp([22],{mvHQ:function(e,t,n){e.exports={default:n("qkKv"),__esModule:!0}},qkKv:function(e,t,n){var o=n("FeBl"),a=o.JSON||(o.JSON={stringify:JSON.stringify});e.exports=function(e){return a.stringify.apply(a,arguments)}},tk9p:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("Xxa5"),a=n.n(o),c=n("mvHQ"),i=n.n(c),r=n("exGp"),s=n.n(r),l=n("MvGc"),d=n("P8Aw"),u=n("M4fF"),h=n.n(u),p={data:function(){return{borderShow:!0}},methods:{back:function(){window.QRScanner&&(window.QRScanner.cancelScan(function(e){console.log(e)}),window.QRScanner.hide()),this.$router.goBack()},handleScanResult:function(e){var t=this;return s()(a.a.mark(function n(){var o,c,r,s,u,p;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.borderShow=!1,t.$q.loading.show(),n.next=4,Object(l.c)(e,"get","","json",!1,!0);case 4:o=n.sent,t.$q.loading.hide(),c=o.data.resultMsg,r=null,r=c.code?c.code.id:c.id,s=null,c.project&&(s=c.project),u=null,c.type&&(u=c.type.key),console.log(u),p=[],c.pictures&&(h.a.forEach(c.pictures,function(e){var t=d.b.THUMBNAIL_API+e.filePath;p.push({previewUrl:t,contentUrl:e.filePath})}),localStorage.setItem("qrcode-image",i()(p))),h.a.isNull(c.location)&&localStorage.setItem("user_location",c.location),localStorage.setItem("qrCodeId",r),localStorage.setItem("typeKey",u),localStorage.setItem("choose-project",i()(s)),u===d.a.SINGLE||u===d.a.AREA?c.maintainable?t.$router.push("/project/maintenance?codeId="+r):t.$router.push("/qcode/detail?id="+r+"type="+u):u===d.a.EQUIPMENT||u===d.a.OTHER?t.$router.push("/qcode/detail?id="+r+"type="+u):null===u&&c.edittable?t.$router.push("/qcode/edit?id="+r+"&typeKey=null"):t.$router.push("/qcode/detail?id="+r+"type="+u);case 21:case"end":return n.stop()}},n,t)}))()},cancelScan:function(){window.QRScanner&&(window.QRScanner.cancelScan(function(e){console.log(e)}),window.QRScanner.hide(),window.QRScanner.destroy(function(e){console.log(e)}))},openScan:function(){var e=this;window.QRScanner&&window.QRScanner.prepare(function(t,n){t&&console.error(t),n.authorized?(console.log("authorized"),window.QRScanner.scan(function(t,n){t?console.log(t):(console.log(n),e.handleScanResult(n),e.cancelScan())}),window.QRScanner.show(function(e){console.log(e)})):n.denied?(console.log(n),window.QRScanner.openSettings()):console.log(n)})}},created:function(){this.openScan()},beforeDestroy:function(){this.cancelScan()}},f=function(){var e=this.$createElement,t=this._self._c||e;return t("q-layout",{attrs:{id:"scan-page"}},[t("q-toolbar",{staticClass:"header"},[t("q-toolbar",{staticClass:"fix"},[t("a",{staticClass:"back-a",on:{click:this.back}},[t("q-item-side",{staticClass:"back-left",attrs:{left:"",icon:"keyboard arrow left"}}),this._v("\n        返回")],1),this._v(" "),t("q-toolbar-title",{staticClass:"header-title"},[this._v("\n        扫描二维码\n      ")]),this._v(" "),t("q-item-side",{attrs:{right:""}})],1)],1),this._v(" "),t("q-icon",{directives:[{name:"show",rawName:"v-show",value:this.borderShow,expression:"borderShow"}],staticClass:"fixed-center",staticStyle:{"font-size":"360px",color:"lightskyblue"},attrs:{name:"ion-qr-scanner"}})],1)},w=[];f._withStripped=!0;var S=n("XyMi"),g=Object(S.a)(p,f,w,!1,null,null,null);g.options.__file="src/pages/qcode/scan.vue";t.default=g.exports}});