webpackJsonp([20],{tk9p:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),o=a.n(r),i=a("mvHQ"),n=a.n(i),c=a("exGp"),s=a.n(c),l=a("MvGc"),d=a("P8Aw"),u=a("M4fF"),p=a.n(u),h={data:function(){return{borderShow:!0}},methods:{back:function(){this.$router.goBack()},handleScanResult:function(e){var t=this;return s()(o.a.mark(function a(){var r,i,c,s,u,h;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.borderShow=!1,t.$q.loading.show(),a.next=4,Object(l.c)(e,"get","","json",!1,!0);case 4:r=a.sent,t.$q.loading.hide(),i=r.data.resultMsg,c=null,c=i.code?i.code.id:i.id,s=null,i.project&&(s=i.project),u=null,i.type&&(u=i.type.key),h=[],i.pictures&&(p.a.forEach(i.pictures,function(e){var t=d.d.THUMBNAIL_API+e.filePath;h.push({previewUrl:t,contentUrl:e.filePath})}),localStorage.setItem("qrcode-image",n()(h))),localStorage.setItem("qrCodeId",c),localStorage.setItem("typeKey",u),localStorage.setItem("choose-project",n()(s)),null===u?i.editable?t.$router.replace("/choose/qrtype?id="+c):t.$router.replace("/qcode/detail?id="+c+"&type="+u):"jobGroup"===t.type?u===d.c.SINGLE||u===d.c.AREA?i.maintainable?t.$router.replace("/project/maintenance?codeId="+c):(t.$q.notify({message:"您无权限添加养护记录",timeout:3e3,type:"info"}),t.$router.replace("/qcode/detail?id="+c+"&type="+u)):t.$router.replace("/qcode/detail?id="+c+"&type="+u):"qrcode"===t.type?i.editable?t.$router.replace("/qcode/edit?id="+c+"&typeKey="+u):(t.$q.notify({message:"您无权限编辑此二维码",timeout:3e3,type:"info"}),t.$router.replace("/qcode/detail?id="+c+"&type="+u)):t.$router.replace("/qcode/detail?id="+c+"&type="+u);case 19:case"end":return a.stop()}},a,t)}))()},openScan:function(){var e=this;cordova.plugins.barcodeScanner&&cordova.plugins.barcodeScanner.scan(function(t){e.handleScanResult(t.text)},function(e){alert("Scanning failed: "+e)},{preferFrontCamera:!1,showFlipCameraButton:!1,showTorchButton:!1,torchOn:!1,saveHistory:!1,prompt:"在扫描区域内放置一个二维码",resultDisplayDuration:0,formats:"QR_CODE",orientation:"portrait",disableAnimations:!0,disableSuccessBeep:!1})}},mounted:function(){this.type=this.$route.query.type,this.openScan()},beforeDestroy:function(){}},f=function(){var e=this.$createElement,t=this._self._c||e;return t("q-layout",{attrs:{id:"scan-page"}},[t("q-toolbar",{staticClass:"header"},[t("q-toolbar",{staticClass:"fix"},[t("a",{staticClass:"back-a",on:{click:this.back}},[t("q-item-side",{staticClass:"back-left",attrs:{left:"",icon:"keyboard arrow left"}}),this._v("\n        返回")],1),this._v(" "),t("q-toolbar-title",{staticClass:"header-title"},[this._v("\n        扫描二维码\n      ")]),this._v(" "),t("q-item-side",{attrs:{right:""}})],1)],1),this._v(" "),t("q-icon",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"fixed-center",staticStyle:{"font-size":"360px",color:"lightskyblue"},attrs:{name:"ion-qr-scanner"}})],1)},y=[];f._withStripped=!0;var m=a("XyMi"),b=Object(m.a)(h,f,y,!1,null,null,null);b.options.__file="src/pages/qcode/scan.vue";t.default=b.exports}});